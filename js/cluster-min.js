var cluster={shellac:function(b,a){function c(a){if(b.currentStyle)var c=b.currentStyle[a];else window.getComputedStyle&&(c=document.defaultView.getComputedStyle(b,null).getPropertyValue(a));return c}null==a&&(a={},a.font=c("font-family"),a.weight=c("font-weight"),a.size=parseInt(c("font-size")),a.style=c("font-style"),a.color=c("color"),a.leading=parseInt(c("line-height")));var d=document.createElement("canvas");d.setAttribute("class","shellac");d.width=b.clientWidth;d.height=b.clientHeight;b.parentNode.insertBefore(d,
b.nextSibling);context=d.getContext("2d");context.fillStyle=a.color;context.font=a.weight+" "+a.style+" "+a.size+"px "+a.font;for(var g=b.innerHTML.split(" "),h=[],f="",e=0;e<g.length;e++){var i=g[e],j=context.measureText(f+" "+i).width;0==e?f=i:j<b.clientWidth?f+=" "+i:(h.push(f),f=i)}h.push(f);for(e=0;e<h.length;e++)context.fillText(h[e],0,e*a.leading+a.size);return d},getTypeData:function(){this.width=this.canvas.clientWidth;this.height=this.canvas.clientHeight;imageData=this.canvas.getContext("2d").getImageData(0,
0,this.width,this.height);p=this.canvas.parentNode;p.removeChild(this.canvas);return imageData},generateShapes:function(){for(var b=[],a=0;a<this.height;a+=this.density)for(var c=0;c<this.width;c+=this.density)0<this.imageData.data[4*(c+a*this.width)-1]&&(b[c*a]=new this.Node(c,a,this));return b},Node:function(b,a,c){var d=this,g=c.radius;d.el=document.createElementNS("http://www.w3.org/2000/svg",c.shape);d.el.setAttribute("opacity",0);var h=parseInt(Math.random()*c.speed);d.el.setAttribute("cx",
0);d.el.setAttribute("cx",b);d.el.setAttribute("cy",a);d.el.setAttribute("r",c.radius);d.el.setAttribute("fill",c.colors[parseInt(4*Math.random())]);window.setTimeout(function(){g+=1;c.root.suspendRedraw(100);d.el.setAttribute("opacity",g);c.root.unsuspendRedrawAll()},h);c.root.appendChild(d.el);d.grow=function(a,b){b.target.Y=0;b.target.X=0;var c=a.radius,d=this;this.loop=function(){a.root.suspendRedraw(100);b.target.Y+=3;b.target.X+=3;b.target.setAttribute("transform","translate("+b.target.X+","+
b.target.Y+")");c+=0.1;b.target.setAttribute("r",c);a.root.unsuspendRedrawAll();b.target.Y<a.timeout&&clearInterval(d.timer)};d.timer=window.setInterval(this.loop,30)};this.el.addEventListener("mouseover",function(a){d.grow(c,a)},!0);d.el.x=b;d.el.y=a;return this},init:function(b){var a=this,b=document.getElementById(b);b.className+=" clustered";a.root=document.createElementNS("http://www.w3.org/2000/svg","svg");a.root.setAttribute("width",b.clientWidth);a.root.setAttribute("height",b.clientHeight);
a.root.setAttribute("id","clustered");window.setTimeout(function(){a.canvas=a.shellac(b);a.imageData=a.getTypeData(b);a.generateShapes();b.appendChild(a.root);b.className+=" active"},100)},root:null,nodes:[],density:8,radius:3,target:"cluster",shape:"circle",speed:1E3,timeout:-700,colors:["#00B6B8","#ED5F4C","#F9A235","#2E3192"]};cluster.init("to_cluster");
